!function(t){var e={};function r(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(o,s,function(e){return t[e]}.bind(null,s));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);class o{constructor(t,e,r,o,s){this.$scope=t,this.$scope.cart=o.getCart();let c=r.get("lang");c?e.use(c):e.use("RU"),s.getLangs().then(t=>{let o="";t.forEach(t=>{o+=c===t?`<option value="${t}" selected>${t}</option>`:`<option value="${t}" >${t}</option>`});let s=document.querySelector("#select-lang");s.innerHTML=o,new SelectFx(s,{onChange:t=>{e.use(t),r.put("lang",t)}})})}}class s{constructor(t,e){this.$scope=t,this.$scope.news=[],e.getNews().then(t=>{this.$scope.news=t,this.$scope.$apply()})}}class c{constructor(t,e,r,o){this.$scope=t,this.$scope.catalog=[],e.sortParam?this.$scope.sortParam=e.sortParam:this.$scope.sortParam="all",this.$scope.offset=8,this.$scope.addOffset=(()=>{this.$scope.catalog.length>this.$scope.offset&&(this.$scope.offset+=4)}),this.$scope.ngRepeatFinish=(()=>{this.__JqueryCode()}),r.getCatalog().then(t=>{this.$scope.catalog=t;let e=o.getCart();this.$scope.catalog.forEach(t=>{e.some(e=>e.id===t.id)?(t.inCart=!0,t.style={display:"none"}):t.inCart=!1}),this.$scope.$apply()}),this.$scope.addProductToCart=(t=>{let e=Object.assign({},t);e.amount=document.querySelector(`div[data-id="${t.id}"] > div > span`).innerText,o.addProduct(e),t.inCart=!0,t.style={display:"none"}})}__JqueryCode(){setTimeout(()=>{$(".dropdown-toggle").dropdown(),[].slice.call(document.querySelectorAll("select.cs-select")).forEach(function(t){"select-lang"===t.id||t.classList.contains("select-true")||(new SelectFx(t),t.classList.add("select-true"))})},100)}}class a{constructor(t,e){this.$scope=t,this.$scope.blog=[],e.getBlog().then(t=>{this.$scope.blog=t,this.$scope.$apply()})}}class i{constructor(t,e){this.$scope=t,this.$scope.cart=e.getCart(),this.$scope.getAllPrice=(()=>e.getAllPrice()),this.$scope.getAllCount=(()=>e.getAllCount()),this.$scope.amountChange=(t=>{if(""===t.amount)return;let r=+t.amount;r&&r>0||(t.amount=1),e.saveToCookies()}),this.$scope.deleteProductInCart=(t=>{e.deleteProductByIndex(t)})}}class l{constructor(t,e,r){this.$scope=t,this.$scope.cart=e.getCart(),this.$scope.discount=0,this.$scope.codeText="",this.$scope.getAllDiscountPrice=(()=>{let t=e.getAllPrice();return t-t*this.$scope.discount}),this.$scope.getAllCount=(()=>e.getAllCount()),this.$scope.getDiscountPrice=(t=>t.price-t.price*this.$scope.discount),this.$scope.applyCode=(t=>{if(this.$scope.codes){for(let e=0;e<this.$scope.codes.length;e++)if(this.$scope.codes[e].code===t)return void(this.$scope.discount=this.$scope.codes[e].discount);this.$scope.discount=0}}),this.$scope.applyCheckOut=(()=>{e.clearCart()}),r.getPromoCodes().then(t=>{this.$scope.codes=t,this.$scope.$apply()}),this.$scope.delivery=20}}class n{constructor(t,e){this.$scope=t,this.$scope.singleBlog=e}}class u{constructor(t,e,r){this.$scope=t,this.$scope.product=r,e.getCart().some(t=>t.id===r.id)?r.inCart=!0:r.inCart=!1,r.amount=1,this.$scope.addProductToCart=(t=>{if(""===this.$scope.product.amount)return;let r=Object.assign({},t);e.addProduct(r),t.inCart=!0}),this.$scope.amountChange=(()=>{if(""===this.$scope.product.amount)return;let t=+this.$scope.product.amount;t&&t>0||(this.$scope.product.amount=1)})}}const p="VtaminkaApp",d=`${p}.controllers`,h=`${p}.services`,g=`${p}.directives`,m=`${p}.filters`;angular.module(d,[]),angular.module(h,[]),angular.module(g,[]),angular.module(m,[]),angular.module(g).directive("headerDirective",function(){return{restrict:"C",templateUrl:"templates/directives/HeaderDirective.html",controller:["$scope","$translate","$cookies","CartService","LocaleService",o]}}),angular.module(g).directive("smallMenuDirective",function(){return{restrict:"C",templateUrl:"templates/directives/SmallMenuDirective.html"}}),angular.module(g).directive("scriptsDirective",function(){return{restrict:"C",templateUrl:"templates/directives/ScriptsDirective.html"}}),angular.module(g).directive("footerDirective",function(){return{restrict:"C",templateUrl:"templates/directives/FooterDirective.html"}}),angular.module(g).directive("contactUsDirective",function(){return{restrict:"C",templateUrl:"templates/directives/ContactUsDirective.html"}}),angular.module(g).directive("newsDirective",function(){return{restrict:"C",templateUrl:"templates/directives/NewsDirective.html",controller:["$scope","NewsService",s]}}),angular.module(g).directive("catalogDirective",function(){return{restrict:"C",templateUrl:"templates/directives/CatalogDirective.html",controller:["$scope","$stateParams","CatalogService","CartService",c]}}),angular.module(g).directive("svgSpriteDirective",function(){return{restrict:"C",templateUrl:"templates/directives/SvgSpriteDirective.html"}}),angular.module(g).directive("blogDirective",function(){return{restrict:"C",templateUrl:"templates/directives/BlogDirective.html",controller:["$scope","BlogService",a]}}),angular.module(g).directive("cartDirective",function(){return{restrict:"C",templateUrl:"templates/directives/CartDirective.html",controller:["$scope","CartService",i]}}),angular.module(g).directive("checkoutDirective",function(){return{restrict:"C",templateUrl:"templates/directives/CheckOutDirective.html",controller:["$scope","CartService","PromoCodeService",l]}}),angular.module(h).service("CatalogService",["$http",class{constructor(t){this.$http=t}async getCatalog(t="app_data/catalog.json"){try{return(await this.$http.get(t)).data}catch(t){return console.log("Exception: getCatalog",t),[]}}async getProductByID(t,e="app_data/catalog.json"){try{let r=await this.$http.get(e);for(let e=0;e<r.data.length;e++)if(r.data[e].id==t)return r.data[e]}catch(t){return console.log("Exception: getProductByID",t),{}}}async getProductByIDS(t,e="app_data/catalog.json"){try{let r=await this.$http.get(e),o=[];for(let e=0;e<r.data.length;e++)-1!==t.indexOf(r.data[e].id)&&o.push(r.data[e]);return o}catch(t){return console.log("Exception: getProductByIDS",t),[]}}}]),angular.module(h).service("NewsService",["$http",class{constructor(t){this.$http=t}async getNews(t="app_data/news.json"){try{return(await this.$http.get(t)).data}catch(t){return console.log("Exception: getNews",t),[]}}}]),angular.module(h).service("BlogService",["$http",class{constructor(t){this.$http=t}async getBlog(t="app_data/blog.json"){try{return(await this.$http.get(t)).data}catch(t){return console.log("Exception: getBlog",t),[]}}async getBlogByID(t,e="app_data/blog.json"){try{let r=await this.$http.get(e);for(let e=0;e<r.data.length;e++)if(r.data[e].id==t)return r.data[e]}catch(t){return console.log("Exception: getBlogByID",t),{}}}}]),angular.module(h).service("CartService",["$cookies","CatalogService",class{constructor(t,e){this.cart=[],this.$cookies=t;try{let t=JSON.parse(this.$cookies.get("cart"));if(t&&Array.isArray(t)){let r=[];t.forEach(t=>{r.push(t.id)}),e.getProductByIDS(r).then(e=>{for(let r=0;r<e.length;r++)e[r].amount=t[r].amount;e.forEach(t=>{this.cart.push(t)})})}}catch(t){console.log("Exception: ",t)}}getCart(){return this.cart}addProduct(t){if(this.cart.some(e=>e.id===t.id))for(let e=0;e<this.cart.length;e++){let r=this.cart[e];if(r.id===t.id){r.amount++;break}}else this.cart.push(t);this.saveToCookies()}clearCart(){this.cart.splice(0,this.cart.length),this.saveToCookies()}deleteProductByIndex(t){this.cart.splice(t,1),this.saveToCookies()}saveToCookies(){this.$cookies.put("cart",JSON.stringify(this.getSimpleCart()))}getSimpleCart(){let t=[];return this.cart.forEach(e=>{t.push({id:e.id,amount:e.amount})}),t}getAllCount(){let t=0;return this.cart.forEach(e=>{t+=+e.amount}),t}getAllPrice(){let t=0;return this.cart.forEach(e=>{t+=e.price*e.amount}),t}}]),angular.module(h).service("LocaleService",["$http",class{constructor(t){this.$http=t}async getLangs(t="app_data/langs/langs.json"){try{return(await this.$http.get(t)).data}catch(t){return console.log("Exception: getLangs",t),[]}}}]),angular.module(h).service("PromoCodeService",["$http",class{constructor(t){this.$http=t}async getPromoCodes(t="app_data/promo-codes.json"){try{return(await this.$http.get(t)).data}catch(t){return console.log("Exception: getPromoCodes",t),[]}}}]),angular.module(m).filter("CatalogSortFilter",function(){return function(t,e){if("all"===e)return t;{let r=[];return t.forEach(t=>{-1!==t.types.indexOf(e)&&r.push(t)}),r}}}),angular.module(m).filter("CatalogOffsetFilter",function(){return function(t,e){if(e>=t.length)return t;{let r=[];for(let o=0;o<e;o++)r.push(t[o]);return r}}});const v=angular.module(p,["ngRoute","ngCookies","ui.router","pascalprecht.translate",d,h,g,m]);v.config(["$stateProvider","$urlRouterProvider","$translateProvider",function(t,e,r){r.useStaticFilesLoader({prefix:"app_data/langs/",suffix:".json"}),angular.injector(["ngCookies"]).invoke(["$cookies",function(t){let e=t.get("lang");e?r.preferredLanguage(e):r.preferredLanguage("RU")}]),e.otherwise("/home"),t.state("home",{url:"/home",views:{content:{templateUrl:"templates/home.html"}}}),t.state("about_us",{url:"/about_us",views:{content:{templateUrl:"templates/about_us.html"}}}),t.state("article",{url:"/article/:singleBlogID",views:{content:{templateUrl:"templates/article.html",controller:["$scope","singleBlog",n]}},resolve:{singleBlog:["$stateParams","BlogService",function(t,e){return e.getBlogByID(t.singleBlogID)}]}}),t.state("blog",{url:"/blog",views:{content:{templateUrl:"templates/blog.html"}}}),t.state("cart",{url:"/cart",views:{content:{templateUrl:"templates/cart.html"}}}),t.state("checkout",{url:"/checkout",views:{content:{templateUrl:"templates/checkout.html"}}}),t.state("contacts",{url:"/contacts",views:{content:{templateUrl:"templates/contacts.html"}}}),t.state("product",{url:"/product/:productID",views:{content:{templateUrl:"templates/product.html",controller:["$scope","CartService","product",u]}},resolve:{product:["$stateParams","CatalogService",function(t,e){return e.getProductByID(t.productID)}]}}),t.state("products",{url:"/products/:sortParam",views:{content:{templateUrl:"templates/products.html",controller:["$scope","$translate","sortParam",function(t,e,r){let o;switch(r){case"all":o="ALL_PRODUCTS";break;case"male":o="MALE_PRODUCTS";break;case"female":o="FEMALE_PRODUCTS";break;case"children":o="CHILDREN_PRODUCTS";break;case"sport":o="SPORT_PRODUCTS"}t.category=o}]}},resolve:{sortParam:["$stateParams",function(t){return t.sortParam}]}})}]),v.run()}]);
//# sourceMappingURL=index.js.map